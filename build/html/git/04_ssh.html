<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. SSH &mdash; fong alpha documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. 代理" href="05_proxy.html" />
    <link rel="prev" title="3. 分支管理" href="03_branch.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> fong
            <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                alpha
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C/C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux/Shell</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Git</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_localRep.html">1. 本地版本库</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_remoteRep.html">2. 远程仓库</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_branch.html">3. 分支管理</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4. SSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssh-key">4.1. 配置 SSH key</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#git-config">git config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">生成密钥</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssh-agent">使用 SSH agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#github">Github 添加公钥</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">测试 SSH 连接</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.2. 参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="05_proxy.html">5. 代理</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../machineLearning/index.html">机器学习</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepLearning/index.html">深度学习</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathematicsAlgorithm/index.html">数理与算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regularExpression/index.html">正则表达式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computerNetwork/index.html">计算机网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../link/index.html">资源链接</a></li>
<li class="toctree-l1"><a class="reference internal" href="../softwares/index.html">实用软件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tech/index.html">Tech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../else/index.html">其他</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fong</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Git</a> &raquo;</li>
      <li><span class="section-number">4. </span>SSH</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/git/04_ssh.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ssh">
<h1><span class="section-number">4. </span>SSH<a class="headerlink" href="#ssh" title="Permalink to this heading"></a></h1>
<p>git 提供两类 URL 地址：</p>
<ul class="simple">
<li><p>HTTPS URL（例如 <a class="reference external" href="https://github.com/user/repo.git">https://github.com/user/repo.git</a>）</p></li>
<li><p>SSH URL（例如 <a class="reference external" href="mailto:git&#37;&#52;&#48;github&#46;com">git<span>&#64;</span>github<span>&#46;</span>com</a>:user/repo.git）</p></li>
</ul>
<p>在命令行上使用 HTTPS URL 将 git clone、git fetch、git pull 或 git push 执行到远程存储库时，将要求提供用户名和密码。</p>
<p>SSH 是一种安全的网络协议（Secure Shell），git 使用这种协议进行远程加密登录。SSH 登录安全性由非对称加密保证，生成一个公钥和一个私钥。
SSH 采用加密技术验证远程主机，同时允许远程主机验证用户。
设置 SSH key 的目的是为了节省输入用户名、密码的过程，同时保证传输安全。</p>
<section id="ssh-key">
<h2><span class="section-number">4.1. </span>配置 SSH key<a class="headerlink" href="#ssh-key" title="Permalink to this heading"></a></h2>
<section id="git-config">
<h3>git config<a class="headerlink" href="#git-config" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="k">global</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span> <span class="s1">&#39;&lt;your name&gt;&#39;</span>
<span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="k">global</span> <span class="n">user</span><span class="o">.</span><span class="n">email</span> <span class="s1">&#39;&lt;your email&gt;&#39;</span>
</pre></div>
</div>
<p>查看配置： <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--global</span> <span class="pre">--list</span></code> 。</p>
<p>所有的配置保存在 <code class="docutils literal notranslate"><span class="pre">~/.gitconfig</span></code> 。</p>
</section>
<section id="id1">
<h3>生成密钥<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>首先检查 <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> 目录是否存在、目录中是否已经存在密钥文件。如果没有，说明还未生成过密钥。执行下列命令生成密钥:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span> <span class="o">-</span><span class="n">C</span> <span class="s2">&quot;&lt;your email&gt;&quot;</span>
</pre></div>
</div>
<p>如果不设置密码可以一路回车。 <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> 目录下会生成 id_rsa（私钥）和 id_rsa.pub（公钥）。</p>
</section>
<section id="ssh-agent">
<h3>使用 SSH agent<a class="headerlink" href="#ssh-agent" title="Permalink to this heading"></a></h3>
<p>SSH agent 是密钥管理器，保护 SSH 密钥并配置身份验证代理，这样就不必在每次使用 SSH 密钥时重新输入密码。
运行 ssh-agent 以后，使用 <code class="docutils literal notranslate"><span class="pre">ssh-add</span></code> 将私钥交给 ssh-agent 保管，其他程序需要身份验证的时候可以将验证申请交给 ssh-agent 来完成整个认证过程。
使用不同的密钥连接到不同的主机时，需要手动指定对应的密钥，而 ssh-agent 可以自动帮助我们选择对应的密钥进行认证。</p>
<p>Linux 系统下 ssh-agent 是自动启动的。</p>
<ul class="simple">
<li><p>执行 <code class="docutils literal notranslate"><span class="pre">ssh-add</span> <span class="pre">-l</span></code> 查看是否有密钥被加载。</p></li>
<li><p>如果没有被加载，则执行 <code class="docutils literal notranslate"><span class="pre">ssh-add</span> <span class="pre">~/.ssh/&lt;private_key_file&gt;</span></code> 加载私钥。</p></li>
</ul>
<p>如果提示 “Error connecting to agent: No such file or directory” 说明你的 ssh-agent 并没有运行，执行 <code class="docutils literal notranslate"><span class="pre">eval</span> <span class="pre">$(ssh-agent)</span></code> 或 <code class="docutils literal notranslate"><span class="pre">eval</span> <span class="pre">`ssh-agent`</span></code> 启动。 <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$SSH_AGENT_PID</span></code> 查看 ssh-agent 进程 ID。
如果想杀掉 ssh-agent 进程，执行 <code class="docutils literal notranslate"><span class="pre">ssh-agent</span> <span class="pre">-k</span></code> 。</p>
</section>
<section id="github">
<h3>Github 添加公钥<a class="headerlink" href="#github" title="Permalink to this heading"></a></h3>
<p>把 <code class="docutils literal notranslate"><span class="pre">~/.ssh</span></code> 目录下公钥的内容添加到 Github 。</p>
</section>
<section id="id2">
<h3>测试 SSH 连接<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% ssh -T git@github.com
Hi &lt;your name&gt;! You&#39;ve successfully authenticated, but GitHub does not provide shell access.
</pre></div>
</div>
<p>如果看到上面的内容，说明连接成功。有时，防火墙会完全拒绝 SSH 连接（端口 22），可以尝试使用通过 HTTPS 端口建立的 SSH 连接克隆。
要测试通过 HTTPS 端口的 SSH 是否可行，请运行以下 SSH 命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>% ssh -T -p 443 git@ssh.github.com
Hi &lt;your name&gt;! You&#39;ve successfully authenticated, but GitHub does not provide shell access.
</pre></div>
</div>
<p>第一次连接会把 <code class="docutils literal notranslate"><span class="pre">[ssh.github.com]:443</span></code> 添加到 <code class="docutils literal notranslate"><span class="pre">~/.ssh/known_hosts</span></code> 。</p>
<p>如果你能在端口 443 上通过 SSH 连接到 <a class="reference external" href="mailto:git&#37;&#52;&#48;ssh&#46;github&#46;com">git<span>&#64;</span>ssh<span>&#46;</span>github<span>&#46;</span>com</a>，则可覆盖你的 SSH 设置来强制与 GitHub.com 的任何连接均通过该服务器和端口运行。
要在 SSH 配置文件中设置此行为，请在 ~/.ssh/config 编辑该文件，并添加以下部分:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Host</span> <span class="n">ssh</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span>
    <span class="n">Hostname</span> <span class="n">ssh</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span>
    <span class="n">Port</span> <span class="mi">443</span>
    <span class="n">User</span> <span class="n">git</span>
</pre></div>
</div>
<p>再次执行 <code class="docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">-T</span> <span class="pre">git&#64;github.com</span></code> 进行验证。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>如果 push 的时候仍然要求输入用户名和密码，说明之前是用 HTTPS URL 指向远程主机，执行以下命令修改成 SSH URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="nb">set</span><span class="o">-</span><span class="n">url</span> <span class="n">origin</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="o">&lt;</span><span class="n">Username</span><span class="o">&gt;/&lt;</span><span class="n">Project</span><span class="o">&gt;.</span><span class="n">git</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id3">
<h2><span class="section-number">4.2. </span>参考资料<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>关于远程仓库</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://docs.github.com/cn/get-started/getting-started-with-git/about-remote-repositories">https://docs.github.com/cn/get-started/getting-started-with-git/about-remote-repositories</a></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>在 HTTPS 端口使用 SSH</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://docs.github.com/cn/authentication/troubleshooting-ssh/using-ssh-over-the-https-port">https://docs.github.com/cn/authentication/troubleshooting-ssh/using-ssh-over-the-https-port</a></p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Git ssh key 作用与配置</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://blog.csdn.net/qq_39366020/article/details/106431194">https://blog.csdn.net/qq_39366020/article/details/106431194</a></p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>ssh agent详解</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://zhuanlan.zhihu.com/p/126117538">https://zhuanlan.zhihu.com/p/126117538</a></p>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>ssh-agent</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://wangchujiang.com/linux-command/c/ssh-agent.html">https://wangchujiang.com/linux-command/c/ssh-agent.html</a></p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Push to GitHub without a password using ssh-key</p></li>
</ol>
<blockquote>
<div><p><a class="reference external" href="https://stackoverflow.com/questions/14762034/push-to-github-without-a-password-using-ssh-key">https://stackoverflow.com/questions/14762034/push-to-github-without-a-password-using-ssh-key</a></p>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="03_branch.html" class="btn btn-neutral float-left" title="3. 分支管理" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="05_proxy.html" class="btn btn-neutral float-right" title="5. 代理" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, fong.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script type="text/javascript">
    $(document).ready(function() {
     $(".toggle > *").hide();
     $(".toggle .header").show();
     $(".toggle .header").click(function() {
      $(this).parent().children().not(".header").toggle(400);
      $(this).parent().children(".header").toggleClass("open");
     })
    });
</script>


</body>
</html>